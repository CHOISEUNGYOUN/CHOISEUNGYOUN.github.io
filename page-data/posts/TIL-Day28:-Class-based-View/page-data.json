{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/TIL-Day28:-Class-based-View/","webpackCompilationHash":"35672371142ac896cb5f","result":{"data":{"markdownRemark":{"id":"203ebc4e-8baf-5f37-84be-0f485945d056","html":"<p>그동안 1차 프로젝트를 진행하느라 개념 정리에 소홀해 졌었다.(<del>그래도 주 5개 포스팅은 지킬려고 Code kata로 때웠다</del>)</br>\n어찌됐든 내가 맡은 부분은 어느정도 완성되었기에, 오늘부터 다시 개념정리를 꼼꼼하게 해보려고 한다. 특히 Django를 학습하는 사람이라면 더더욱 이 부분에 대해서 절실하게 깨달을 건데,\n그 이유는 바로 Django의 기능이 3세대 웹 기술과는 조금 동떨어져 있기 때문이다. 이런 관점을 생각하지 않고 Django를 접하게 된다면 아마 머나먼 산으로 떠나게 될 것이다.(<del>필자도 멀리 갔다 왔었다</del>)</br>\n특히 우리가 중요하게 다룰 Class-based Views 속성에 backend를 공부하는 Python 유저에게 필요 없는 것들이 많아, 우리가 직접 사용할 중요한 개념만 짚어보고자 한다.</p>\n<h2 id=\"class-based-views-란-무엇인가\"><a href=\"#class-based-views-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"class based views 란 무엇인가 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Class-based Views 란 무엇인가???</h2>\n<p>Class-based Views는 말 그대로 Django의 Views class 속성을 의미한다. 즉, Views에서 함수형으로 데이터를 보여 줄 수도 있고, class형으로 보여줄 수 있다는 말이다. 필자는 이번 프로젝트에서 철저히 Class-based Views 속성에서도 django.views.generic.base.View 속성만 사용하였다. <strong>(3세대 웹 개발 패러다임을 고려한다면 base만 사용해도 충분히 모든 기능을 구현할 수 있으니 당장 필요하지 않다면, 학습하지 않는것이 좋다.)</strong></br> 그럼 Base view에 대한 기능들을 하나씩 살펴보자.</p>\n<h3 id=\"1-view-class의-http-method-수신--송출을-담당한다\"><a href=\"#1-view-class%EC%9D%98-http-method-%EC%88%98%EC%8B%A0--%EC%86%A1%EC%B6%9C%EC%9D%84-%EB%8B%B4%EB%8B%B9%ED%95%9C%EB%8B%A4\" aria-label=\"1 view class의 http method 수신  송출을 담당한다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. View class의 HTTP method 수신 &#x26; 송출을 담당한다.</h3>\n<p>View를 class로 상속 받은 class는 base view에 있는 HTTP 통신 프로토콜에 대한 기능들 또한 상속받는다. 그리하여 프론트엔드에서 요청하는 HTTP 종류에 따라 그에 맞는 함수를 사용하여야 한다. 해당되는 함수의 종류는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[&#39;get&#39;, &#39;post&#39;, &#39;put&#39;, &#39;patch&#39;, &#39;delete&#39;, &#39;head&#39;, &#39;options&#39;, &#39;trace&#39;]</code></pre></div>\n<p>이외에 connect 기능이 있으나, Django Views class에서는 지원하지 않는다.\n또한, 8가지 기능이 있다고 하더라도, 기본적으로 get, post, delete 세가지 기능 외에는 잘 사용되지 않는다. 이에 대한 간단한 예시를 코드로 첨부하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TweetsView</span><span class=\"token punctuation\">(</span>View<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\n  <span class=\"token comment\">#get으로 tweet data 송출</span>\n  <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> pg_num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\tuser_tweets <span class=\"token operator\">=</span> Tweets<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">return</span> JsonResponse<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>user_tweets<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> safe<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">#post로 tweet 작성</span>\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\tdata <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n\t\ttweet <span class=\"token operator\">=</span> Tweets<span class=\"token punctuation\">(</span>user<span class=\"token operator\">=</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t\t      content<span class=\"token operator\">=</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\t\ttweet<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">return</span> JsonResponse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"SUCCESS\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> status<span class=\"token operator\">=</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>아마 위의 두가지 기능이 가장 많이 사용될 것이기에, Django를 처음 접하시는 분이라면 위의 구조를 하나하나씩 살펴보면 좋을 것 같다.</p>\n<h3 id=\"2-class-단위로-url또는-endpoint를-생성-및-참조한다\"><a href=\"#2-class-%EB%8B%A8%EC%9C%84%EB%A1%9C-url%EB%98%90%EB%8A%94-endpoint%EB%A5%BC-%EC%83%9D%EC%84%B1-%EB%B0%8F-%EC%B0%B8%EC%A1%B0%ED%95%9C%EB%8B%A4\" aria-label=\"2 class 단위로 url또는 endpoint를 생성 및 참조한다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Class 단위로 url(또는 endpoint)를 생성 및 참조한다.</h3>\n<p>base view를 상속받은 class가 제대로 작동하기 위해서는 endpoint를 생성할 필요가 있다. 이를 인식하는 방법이 urls.py에서 path() 메서드를 활용하여 해당 endpoint가 view class 참조 할 수 있도록 만들 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>urls <span class=\"token keyword\">import</span> path \n<span class=\"token keyword\">from</span> <span class=\"token punctuation\">.</span>views <span class=\"token keyword\">import</span> TweetsView\n \nurlpatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n     path<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;int:pg_num>/'</span><span class=\"token punctuation\">,</span> TweetsView<span class=\"token punctuation\">.</span>as_view<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>상기 코드는 TweetsView라는 View class에 &#x3C;int:pg<em>num>으로 숫자로 end-point를 가리킨다는 의미로 작성되었다. 여기서, View의 as</em>view라는 메서드를 사용하였는데 이를 통하여 우리가 작성한 View들이 HTTP 통신들을 받을 수 있도록 도와준다. as_view의 Django source code는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">    <span class=\"token keyword\">def</span> <span class=\"token function\">as_view</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>initkwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        Main entry point for a request-response process.\n        \"\"\"</span>\n        <span class=\"token keyword\">for</span> key <span class=\"token keyword\">in</span> initkwargs<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> key <span class=\"token keyword\">in</span> cls<span class=\"token punctuation\">.</span>http_method_names<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">raise</span> TypeError<span class=\"token punctuation\">(</span><span class=\"token string\">\"You tried to pass in the %s method name as a \"</span>\n                                <span class=\"token string\">\"keyword argument to %s(). Don't do that.\"</span>\n                                <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">.</span>__name__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">raise</span> TypeError<span class=\"token punctuation\">(</span><span class=\"token string\">\"%s() received an invalid keyword %r. as_view \"</span>\n                                <span class=\"token string\">\"only accepts arguments that are already \"</span>\n                                <span class=\"token string\">\"attributes of the class.\"</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">.</span>__name__<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n       <span class=\"token keyword\">def</span> <span class=\"token function\">view</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self <span class=\"token operator\">=</span> cls<span class=\"token punctuation\">(</span><span class=\"token operator\">**</span>initkwargs<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">'head'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>head <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>get\n            self<span class=\"token punctuation\">.</span>request <span class=\"token operator\">=</span> request\n            self<span class=\"token punctuation\">.</span>args <span class=\"token operator\">=</span> args\n            self<span class=\"token punctuation\">.</span>kwargs <span class=\"token operator\">=</span> kwargs\n            <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>dispatch<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span>\n        view<span class=\"token punctuation\">.</span>view_class <span class=\"token operator\">=</span> cls\n        view<span class=\"token punctuation\">.</span>view_initkwargs <span class=\"token operator\">=</span> initkwargs\n\n        <span class=\"token comment\"># take name and docstring from class</span>\n        update_wrapper<span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">,</span> updated<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># and possible attributes set by decorators</span>\n        <span class=\"token comment\"># like csrf_exempt from dispatch</span>\n        update_wrapper<span class=\"token punctuation\">(</span>view<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">.</span>dispatch<span class=\"token punctuation\">,</span> assigned<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> view</code></pre></div>\n<p>좀 더 이해 할 수 있도록 view 함수와 함께 가져왔는데,(상기 코드는 Django source code이다.) 위에서 볼 수 있듯이, as_view()라는 메서드가 end-point로 향하는 entry-point 역할을 수행하며, HTTP request &#x26; response만을 수신 및 송출 할 수 있도록 도와준다.</p>\n<p>이정도 까지만 이해 한다면, 당신도 바로 Django로 backend를 구축할 수 있다!!!</p>\n<p><em>Reference: <a href=\"https://simpleisbetterthancomplex.com/article/2017/03/21/class-based-views-vs-function-based-views.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vitor Freitas - Class-Based Views vs. Function-Based Views</a></br> <a href=\"https://docs.djangoproject.com/en/2.2/topics/class-based-views/intro/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Django - Introduction to class-based views</a></br> <a href=\"https://docs.djangoproject.com/en/2.2/ref/class-based-views/base/#django.views.generic.base.View.http_method_names\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Django - Base views</a></br> <a href=\"https://github.com/django/django/blob/1.10.6/django/views/generic/base.py#L46\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Github - Django</a></em></p>","fields":{"slug":"/posts/TIL-Day28:-Class-based-View/","tagSlugs":["/tag/python/","/tag/django/","/tag/views/","/tag/mvt/"]},"frontmatter":{"date":"2019-08-26T22:40:32.169Z","description":"Django의 Class-based Views에 대해 한번 알아보자!!","tags":["Python","Django","Views","MVT"],"title":"TIL - Day28: Class-based View "}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/TIL-Day28:-Class-based-View/"}}}